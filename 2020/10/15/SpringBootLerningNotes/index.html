<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Spring Boot入门 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一、Spring Boot入门1.Spring Boot简介 主要作用：简化Spring的开发，免去了SpringMVC各种配置文件的繁琐，并且部署项目是不需要打成war  2.微服务 2014，Martin Fowler  In short, the microservice architectural style is an approach to developing a single a">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Boot入门">
<meta property="og:url" content="http://example.com/2020/10/15/SpringBootLerningNotes/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="一、Spring Boot入门1.Spring Boot简介 主要作用：简化Spring的开发，免去了SpringMVC各种配置文件的繁琐，并且部署项目是不需要打成war  2.微服务 2014，Martin Fowler  In short, the microservice architectural style is an approach to developing a single a">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/Users/wjtang/Pictures/concrete-bindings.png">
<meta property="og:image" content="http://example.com/Users/wjtang/Pictures/legacy.png">
<meta property="article:published_time" content="2020-10-15T03:23:55.857Z">
<meta property="article:modified_time" content="2020-11-16T13:22:42.533Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/Users/wjtang/Pictures/concrete-bindings.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-SpringBootLerningNotes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/15/SpringBootLerningNotes/" class="article-date">
  <time datetime="2020-10-15T03:23:55.857Z" itemprop="datePublished">2020-10-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Spring Boot入门
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h1 id="一、Spring-Boot入门"><a href="#一、Spring-Boot入门" class="headerlink" title="一、Spring Boot入门"></a>一、Spring Boot入门</h1><h2 id="1-Spring-Boot简介"><a href="#1-Spring-Boot简介" class="headerlink" title="1.Spring Boot简介"></a>1.<a target="_blank" rel="noopener" href="https://spring.io/projects/spring-boot">Spring Boot</a>简介</h2><ul>
<li><strong>主要作用</strong>：简化Spring的开发，免去了SpringMVC各种配置文件的繁琐，并且部署项目是不需要打成war</li>
</ul>
<h2 id="2-微服务"><a href="#2-微服务" class="headerlink" title="2.微服务"></a>2.微服务</h2><ul>
<li><p>2014，Martin Fowler</p>
</li>
<li><p>In short, the microservice architectural style is an approach to developing a single application as a <strong>suite of small services</strong>,     each <strong>running in its own process</strong> and communicating with lightweight mechanisms, often an HTTP resource API. These services are <strong>built around business capabilities</strong> and <strong>independently deployable</strong> by fully automated deployment machinery. There is a <strong>bare minimum of centralized management</strong> of these services, which may be written in different programming languages and use different data storage technologies.</p>
<p>– <a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html">James Lewis and Martin Fowler (2014)</a></p>
</li>
<li><p>每一个应用都被拆解成一组小型服务，服务之间可以交互，通常用HTTP进行；</p>
</li>
<li><p>每一个服务都独立部署，可独立升级和替换</p>
</li>
</ul>
<h2 id="3-环境准备"><a href="#3-环境准备" class="headerlink" title="3.环境准备"></a>3.环境准备</h2><h3 id="1-IDEA"><a href="#1-IDEA" class="headerlink" title="1.IDEA"></a>1.IDEA</h3><h3 id="2-maven"><a href="#2-maven" class="headerlink" title="2.maven"></a>2.maven</h3><h2 id="4-Spring-Boot-HelloWorld"><a href="#4-Spring-Boot-HelloWorld" class="headerlink" title="4.Spring Boot HelloWorld"></a>4.Spring Boot HelloWorld</h2><h3 id="1-新建maven项目"><a href="#1-新建maven项目" class="headerlink" title="1.新建maven项目"></a>1.新建maven项目</h3><h3 id="2-配置pom-xml-导入Spring-Boot相关依赖"><a href="#2-配置pom-xml-导入Spring-Boot相关依赖" class="headerlink" title="2.配置pom.xml,导入Spring Boot相关依赖"></a>2.配置pom.xml,导入Spring Boot相关依赖</h3><h3 id="3-编写main函数，用来启动SpringBootApplication"><a href="#3-编写main函数，用来启动SpringBootApplication" class="headerlink" title="3.编写main函数，用来启动SpringBootApplication"></a>3.编写main函数，用来启动SpringBootApplication</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *<span class="doctag">@SpringBootApplication</span> 标注此函数是一个SpringBootApplication</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloSpringBoot</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HelloSpringBoot.class,args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-编写Contorller"><a href="#4-编写Contorller" class="headerlink" title="4.编写Contorller"></a>4.编写Contorller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-运行-main"><a href="#5-运行-main" class="headerlink" title="5.运行 main"></a>5.运行 main</h2><p>​    浏览器中输入<a target="_blank" rel="noopener" href="http://localhost:8080/hello">http://localhost:8080/hello</a> ，浏览器即可得到response（“Hello World!”）</p>
<h2 id="6-将项目打成jar包，如下"><a href="#6-将项目打成jar包，如下" class="headerlink" title="6.将项目打成jar包，如下"></a>6.将项目打成jar包，如下</h2><p>![](/Users/wjtang/Pictures/屏幕快照 2020-10-15 13.58.14.png)</p>
<h2 id="7-一键部署"><a href="#7-一键部署" class="headerlink" title="7.一键部署"></a>7.一键部署</h2><ul>
<li>terminal进入jar包所在目录，运行java -jar XXX.jar,即可完成一键部署；下图</li>
</ul>
<h2 id="屏幕快照-2020-10-15-14-09-38-Users-wjtang-Pictures-屏幕快照-2020-10-15-14-09-38-png-8-SpringBootApplication-HelloWorld源码解析"><a href="#屏幕快照-2020-10-15-14-09-38-Users-wjtang-Pictures-屏幕快照-2020-10-15-14-09-38-png-8-SpringBootApplication-HelloWorld源码解析" class="headerlink" title="![屏幕快照 2020-10-15 14.09.38](/Users/wjtang/Pictures/屏幕快照 2020-10-15 14.09.38.png)8.SpringBootApplication-HelloWorld源码解析"></a>![屏幕快照 2020-10-15 14.09.38](/Users/wjtang/Pictures/屏幕快照 2020-10-15 14.09.38.png)8.SpringBootApplication-HelloWorld源码解析</h2><ul>
<li><p><strong>/org/springframework/boot/spring-boot-autoconfigure/2.3.3.RELEASE/spring-boot-autoconfigure-2.3.3.RELEASE.jar</strong>包下配置了javaEE的整合解决方案</p>
</li>
<li><p><strong>/org/springframework/boot/spring-boot-autoconfigure/2.3.3.RELEASE/spring-boot-autoconfigure-2.3.3.RELEASE.jar/META-INF/spring.factories</strong>实现自动配置功能组件，免去了手动配置的工作</p>
</li>
</ul>
<h2 id="9-使用Spring-Initializer快速创建Spring-Boot项目"><a href="#9-使用Spring-Initializer快速创建Spring-Boot项目" class="headerlink" title="9.使用Spring Initializer快速创建Spring Boot项目"></a>9.使用Spring Initializer快速创建Spring Boot项目</h2><ul>
<li>main已经写好，只需要我们写一下Controller</li>
<li>resources文件夹中目录结构<ul>
<li>static 保存静态文件</li>
<li>Templates 保存页面模版（默认不支持jsp，Spring Boot默认 jar包使用嵌入式的Tomcat）；可使用模版引擎（freemarker、thymeleaf）</li>
<li>application.properties  配置Spring Boot各种参数,可修改一些默认设置（如 server.port=8081 可将服务器端口号换成8081）</li>
</ul>
</li>
<li>【注】 <ul>
<li>问题：IDEA可能卡在reading pom.xml </li>
<li>原因：默认从Apache的服务器取jar包，服务器在美国，出现卡顿</li>
<li>解决方案：1）删除.mvn文件夹 2）配置使用本地的maven及setting.xml    </li>
</ul>
</li>
</ul>
<h1 id="二、配置文件"><a href="#二、配置文件" class="headerlink" title="二、配置文件"></a>二、配置文件</h1><h2 id="1-配置文件-修改Spring-Boot自动配置的默认值"><a href="#1-配置文件-修改Spring-Boot自动配置的默认值" class="headerlink" title="1.配置文件(修改Spring Boot自动配置的默认值)"></a>1.配置文件(修改Spring Boot自动配置的默认值)</h2><p>Spring Boot使用全局的配置文件（文件名固定）</p>
<ul>
<li>application.properties</li>
<li>application.yml（yml 全称 YMAL : Ain’t a Markup langauage，比json、xml更简洁）</li>
</ul>
<p>yml:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br></pre></td></tr></table></figure>

<p>xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">port</span>&gt;</span>8081<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-YAML基本语法"><a href="#2-YAML基本语法" class="headerlink" title="2.YAML基本语法"></a>2.YAML基本语法</h2><h3 id="1-基本语法"><a href="#1-基本语法" class="headerlink" title="1.基本语法"></a>1.基本语法</h3><ul>
<li>k: v  键值对</li>
<li>以<strong>空格</strong>的缩进控制层级关系；（左对齐的为同一层级）</li>
<li>大小写敏感</li>
</ul>
<h3 id="2-值的写法"><a href="#2-值的写法" class="headerlink" title="2.值的写法"></a>2.值的写法</h3><ul>
<li><p>数字、字符串、布尔等普通值</p>
<ul>
<li>k: v 直接写</li>
<li>字符串默认不加单引号和双引号,如果加了<ul>
<li>“” ：”a \n b” 输出 a (换行) b; \n会生效</li>
<li>‘’ : ‘a \n b’ 输出 a \n b ; \n 不生效</li>
</ul>
</li>
</ul>
</li>
<li><p>对象、Map </p>
<ol>
<li>对象</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Friends:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">zhangsan</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Friends:</span> &#123;<span class="attr">lastName:</span> <span class="string">zhangsan</span>,<span class="attr">age:</span> <span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>数组</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pets:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">dog</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">pig</span></span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pets:</span> [<span class="string">cat</span>,<span class="string">dog</span>,<span class="string">pig</span>]</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="3-在配置文件中配置类的值"><a href="#3-在配置文件中配置类的值" class="headerlink" title="3.在配置文件中配置类的值"></a>3.在配置文件中配置类的值</h2><ul>
<li>首先在要配置的类开头加上如下注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* ConfigurationProperties: 告诉SpringBoot将本类中的所有属性 在 配置文件中进行配置</span></span><br><span class="line"><span class="comment">* Component：容器 只有这个组件放到容器中，才能使用上述的配置功能</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    String password;</span><br><span class="line">    Dog dog;</span><br></pre></td></tr></table></figure>

<ul>
<li>在引用使用person的注解时，需要加上@Autowired</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">@Autowired 保证person能够联系上配置文件中的内容</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuickStartSpringbootapplicationApplicationTests</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    Person person;</span><br></pre></td></tr></table></figure>

<p>下面给出两种配置文件</p>
<ul>
<li>yml</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zhangsan</span></span><br><span class="line">  <span class="attr">passwrod:</span> <span class="number">18</span></span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dog1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>properties</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">person.name</span>=<span class="string">jack</span></span><br><span class="line"><span class="meta">person.password</span>=<span class="string">1234</span></span><br><span class="line"><span class="meta">person.dog.name</span>=<span class="string">dog1</span></span><br></pre></td></tr></table></figure>

<h3 id="1-properties文件中文乱码问题"><a href="#1-properties文件中文乱码问题" class="headerlink" title="1.properties文件中文乱码问题"></a>1.properties文件中文乱码问题</h3><ul>
<li>勾选以下配置，重建properties文件（防止不自动刷新）</li>
</ul>
<p>![，](/Users/wjtang/Pictures/屏幕快照 2020-10-17 13.01.03.png)</p>
<h3 id="2-Value和-ConfigurationProperties"><a href="#2-Value和-ConfigurationProperties" class="headerlink" title="2.@Value和@ConfigurationProperties"></a>2.@Value和@ConfigurationProperties</h3><table>
<thead>
<tr>
<th></th>
<th>@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody><tr>
<td>功能</td>
<td>批量配置</td>
<td>一个个配置</td>
</tr>
<tr>
<td>松散语法</td>
<td>支持：如lastName可写成last-name</td>
<td>不支持</td>
</tr>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持：如11*2可算出结果</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody></table>
<ul>
<li>@Value只能赋予基本类型的值</li>
<li>@Value的优先级较@ConfigurationProperties高</li>
</ul>
<h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>需要<strong>单个</strong>配置文件中的值，使用@Value</li>
<li>需要配置某个javaBean，使用@ConfigurationProperties</li>
</ul>
<h3 id="Value示例"><a href="#Value示例" class="headerlink" title="@Value示例"></a>@Value示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">//@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;person.name&#125;&quot;)</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="meta">@Value(&quot;#&#123;11*22&#125;&quot;)</span><span class="comment">//@Value的优先级较@ConfigurationProperties高</span></span><br><span class="line">    String password;</span><br><span class="line">    <span class="comment">//@Value(&quot;$&#123;person.dog&#125;&quot;)</span></span><br><span class="line">    Dog dog;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;person.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/sayHello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">&quot;hello &quot;</span>+<span class="keyword">this</span>.name;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-PropertySource和-ImportResource"><a href="#3-PropertySource和-ImportResource" class="headerlink" title="3.@PropertySource和@ImportResource"></a>3.@PropertySource和@ImportResource</h3><ol>
<li>@PropertySource加载指定的**.properties**配置文件（@ConfigurationProperties默认从全局配置文件获取值）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(value = &#123;&quot;classpath:person.properties&quot;&#125;)</span><span class="comment">//从指定配置文件获取数据</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span><span class="comment">//从applicaiton.properties(全局配置文件)获取数据</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@Value(&quot;$&#123;person.name&#125;&quot;)</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="meta">@Value(&quot;#&#123;11*22&#125;&quot;)</span><span class="comment">//@Value的优先级较@ConfigurationProperties高</span></span><br><span class="line">    String password;</span><br><span class="line">    Dog dog;<span class="comment">//@Value不能获取复杂类型，故此处不可用</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>@ImportResource 在导入Spring专属的**.xml<strong>配置文件，使其</strong>生效**</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ImportResource(locations = &#123;&quot;classpath:beans.xml&quot;&#125;)</span><span class="comment">//在主配置类中导入Spring的配置文件</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickStartSpringbootapplicationApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(QuickStartSpringbootapplicationApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Spring的配置文件示例（beans.xml）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;helloService&quot; class=&quot;com.springinitializer.quickstartspringbootapplication.service.HelloService&quot;&lt;/bean&gt;</span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ol start="3">
<li>SpringBoot推荐给容器中添加组件的方式：**@Bean**注解的Spring配置类 （相当于一个Spring配置文件，而且能自动生效）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*配置类 = Spring配置文件+@ImportResource</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="meta">@Configuration</span><span class="comment">//指明当前类为Spring配置类：相当于Spring配置文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@Bean标志此方法是一个组件，该组件的返回值添加到容器中，id默认为方法名</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloService <span class="title">helloService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第一个Spring配置类：&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HelloService();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-配置文件占位符（-）"><a href="#4-配置文件占位符（-）" class="headerlink" title="4.配置文件占位符（${}）"></a>4.配置文件占位符（${}）</h2><ol>
<li>随机数</li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">person.name</span>=<span class="string">张三$&#123;random.uuid&#125;</span></span><br><span class="line"><span class="meta">person.password</span>=<span class="string">1234</span></span><br><span class="line"><span class="meta">person.dog.name</span>=<span class="string">dog1</span></span><br></pre></td></tr></table></figure>

<p>2.获取之前配置的值(若没有配置 : 冒号代表默认值)</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">person.password</span>=<span class="string">1234$&#123;person.hello:hello&#125;</span></span><br><span class="line"><span class="meta">person.dog.name</span>=<span class="string">dog1$&#123;person.password&#125; </span></span><br></pre></td></tr></table></figure>

<h2 id="5-Profile文件"><a href="#5-Profile文件" class="headerlink" title="5.Profile文件"></a>5.Profile文件</h2><h3 id="1-多Profile文件"><a href="#1-多Profile文件" class="headerlink" title="1.多Profile文件"></a>1.多Profile文件</h3><p>实际开发时可能用到多套配置文件（开发、测试、上线），所以写多个.properties文件（默认为application.properties）</p>
<p>![屏幕快照 2020-10-20 11.23.08](/Users/wjtang/Pictures/屏幕快照 2020-10-20 11.23.08.png)</p>
<h3 id="2-激活指定profile"><a href="#2-激活指定profile" class="headerlink" title="2.激活指定profile"></a>2.激活指定profile</h3><p>​    将以下代码写入application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure>

<h3 id="3-yml的多文档块-—-表示分块"><a href="#3-yml的多文档块-—-表示分块" class="headerlink" title="3.yml的多文档块(— 表示分块)"></a>3.yml的多文档块(— 表示分块)</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#---代表分块</span></span><br><span class="line"><span class="comment">#激活某一块，用如下的active：profile-name</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">development</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8082</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">development</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8083</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">product</span></span><br></pre></td></tr></table></figure>

<h3 id="4-命令行激活"><a href="#4-命令行激活" class="headerlink" title="4.命令行激活"></a>4.命令行激活</h3><p>运行时，可以通过命令指定profile文件（–spring.profiles.active=dev）</p>
<p>java -jar XXX.jar –spring.profiles.active=dev;</p>
<p>【注】：运行jar包时才可以用</p>
<h2 id="6-配置文件加载位置"><a href="#6-配置文件加载位置" class="headerlink" title="6.配置文件加载位置"></a>6.配置文件加载位置</h2><ul>
<li><p>Spring Boot默认到以下位置扫描application.properties 或者 application.yml作为Spring boot的默认配置文件</p>
<ul>
<li>file:./config/</li>
<li>File:./</li>
<li>Classpath:/config/</li>
<li>Classpath:/</li>
</ul>
<p>【注】：以上按照<strong>优先级从高到低</strong>的顺序，<strong>所有位置</strong>的文件都会被加载，不同内容<strong>互补</strong>，相同</p>
<p>高优先级配置会<strong>覆盖</strong>低优先级内容</p>
<p>可以通过配置spring.config.location来改变默认配置</p>
</li>
</ul>
<h2 id="7-外部配置加载顺序"><a href="#7-外部配置加载顺序" class="headerlink" title="7.外部配置加载顺序"></a>7.外部配置加载顺序</h2><p>SpringBoot也可以从以下位置加载配置；优先级从高到低；不同内容互补，相同的高优先级覆盖低优先级</p>
<h3 id="1-命令行参数"><a href="#1-命令行参数" class="headerlink" title="1.命令行参数"></a>1.命令行参数</h3><p>java -jar XXX.jar –server.port=8087 –server.context-path=/abc</p>
<h3 id="2-加载顺序"><a href="#2-加载顺序" class="headerlink" title="2.加载顺序"></a>2.加载顺序</h3><ul>
<li>优先加载带profile<ul>
<li>jar包外部带profile的文件（application-{profile}.properties或application.yml(带spring.profile)）</li>
<li>jar包内部带profile的文件</li>
</ul>
</li>
<li>再加载不带profile<ul>
<li>jar包外部不带profile</li>
<li>jar包内部不带profile</li>
</ul>
</li>
</ul>
<p>总结：1）先看带不带profile（带profile的优先级高）</p>
<p>​           2）再看在jar包内外部（jar包外部配置文件优先级高）</p>
<p>【注】：将配置文件放到jar包外部（同一文件夹下），配置文件会自动被加载</p>
<h2 id="8-自动配置原理"><a href="#8-自动配置原理" class="headerlink" title="8.自动配置原理"></a>8.自动配置原理</h2><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.3.4.RELEASE/reference/htmlsingle/#common-application-properties">配置文件的属性参照</a></p>
<p>自动配置原理：</p>
<ol>
<li>SpringBoot启动时加载主配置类，开启自动配置@EnableAutoConfiguration</li>
<li>看我们需要的功能在SpringBoot中有没有默认写好的自动配置类</li>
<li>看该自动配置中有哪些组件</li>
<li>手动给自动配置类中添加组件时，会从properties中获取某些属性，我们就要在properties文件中指定这些属性的值</li>
</ol>
<h1 id="三、日志"><a href="#三、日志" class="headerlink" title="三、日志"></a>三、日志</h1><h2 id="1-日志框架"><a href="#1-日志框架" class="headerlink" title="1.日志框架"></a>1.日志框架</h2><ul>
<li><p>市面上日志框架</p>
<ul>
<li>JUL,JCL,Jboss-logging,logback,log4j,log4j2,slf4j…</li>
</ul>
<table>
<thead>
<tr>
<th>日志门面（日志的抽象层）</th>
<th>日志实现</th>
</tr>
</thead>
<tbody><tr>
<td><del>JCL(Jakarta Commons Logging)</del>, SLF4j(Simple Logging Facade for Java), <del>jboss-logging</del></td>
<td>Log4j, JUL(java.util.logging), Log4j2, Logback</td>
</tr>
</tbody></table>
<p>使用时左边选一个门面（抽象层），右边选一个实现；</p>
<p>日志门面：<a target="_blank" rel="noopener" href="http://www.slf4j.org/">SLF4j</a></p>
<p>日志实现：Logback</p>
</li>
<li><p>SpringBoot:底层是Spring框架，而Spring框架默认是JCL；但是SpringBoot选用SLF4j和Logback</p>
</li>
</ul>
<h2 id="2-SLF4j使用"><a href="#2-SLF4j使用" class="headerlink" title="2.SLF4j使用"></a>2.SLF4j使用</h2><h3 id="1-日志框架的使用问题"><a href="#1-日志框架的使用问题" class="headerlink" title="1.日志框架的使用问题"></a>1.日志框架的使用问题</h3><p>开发时，不应该直接调用日志的实现类，而是调用日志抽象层（日志门面）里的方法；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Logger logger = LoggerFactory.getLogger(HelloWorld.class);</span><br><span class="line">    logger.info(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SLF4J的工作原理见下图：</p>
<p><img src="/Users/wjtang/Pictures/concrete-bindings.png" alt="concrete-bindings"></p>
<p>每一个日志的实现框架都有自己的配置文件，使用SLF4J后，各个日志实现框架的配置文件保持不变</p>
<h3 id="2-遗留问题"><a href="#2-遗留问题" class="headerlink" title="2.遗留问题"></a>2.遗留问题</h3><p><strong>如何统一日志记录</strong>？</p>
<p>当依赖其他框架（Spring(commons-logging),Hibernate(jobs-logging),MyBatis…）时，如何统一？</p>
<p>答案：用XXX-slf4j.jar来代替原有的jar包（如log4j-over-slf4j.jar 代替 log4j.jar）</p>
<p><img src="/Users/wjtang/Pictures/legacy.png"></p>
<h3 id="3-将系统中所有的日志都统一到slf4j具体步骤"><a href="#3-将系统中所有的日志都统一到slf4j具体步骤" class="headerlink" title="3.将系统中所有的日志都统一到slf4j具体步骤"></a>3.将系统中所有的日志都统一到slf4j具体步骤</h3><ol>
<li>将系统中其他日志框架先<strong>移除</strong></li>
<li>用XXX-slf4j.jar替换原有的jar包</li>
<li>导入slf4j其它的实现</li>
</ol>
<h2 id="3-SpringBoot的日志依赖"><a href="#3-SpringBoot的日志依赖" class="headerlink" title="3.SpringBoot的日志依赖"></a>3.SpringBoot的日志依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-日志使用"><a href="#4-日志使用" class="headerlink" title="4.日志使用"></a>4.日志使用</h2><h3 id="1-默认配置"><a href="#1-默认配置" class="headerlink" title="1.默认配置"></a>1.默认配置</h3><p>SpringBoot默认帮我们配置好了日志，代码示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用日志打印信息</span></span><br><span class="line">    Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//System.out.println(person);</span></span><br><span class="line">        <span class="comment">//日志的级别，由低到高，可以调整输出的日志级别，spring默认输出info及以上的级别</span></span><br><span class="line">        logger.trace(<span class="string">&quot;这是trace日志&quot;</span>);</span><br><span class="line">        logger.debug(<span class="string">&quot;这是debug日志&quot;</span>);</span><br><span class="line">        logger.info(<span class="string">&quot;这是info日志&quot;</span>);</span><br><span class="line">        logger.warn(<span class="string">&quot;这是warn日志&quot;</span>);</span><br><span class="line">        logger.error(<span class="string">&quot;这是error日志&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Spring默认输出info及以上级别的日志信息，也可以自己配置日志输出级别（在*.properties 或 *.yml）,yml文件配置示例：</p>
<ul>
<li>指定日志文件path</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">trace</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/Users/wjtang/IdeaProjects</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指定日志文件name</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">trace</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">/Users/wjtang/IdeaProjects/testLog.log</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指定输出格式pattern</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">trace</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">/Users/wjtang/IdeaProjects/testLog.log</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="attr">console:</span></span><br><span class="line">    <span class="attr">file:</span></span><br></pre></td></tr></table></figure>

<h2 id="5-切换日志框架"><a href="#5-切换日志框架" class="headerlink" title="5.切换日志框架"></a>5.切换日志框架</h2><p>可以按照slf4j的日志适配图，进行相关的切换；</p>
<h1 id="四、Spring-Boot与Web开发"><a href="#四、Spring-Boot与Web开发" class="headerlink" title="四、Spring Boot与Web开发"></a>四、Spring Boot与Web开发</h1><h2 id="1-使用SpringBoot"><a href="#1-使用SpringBoot" class="headerlink" title="1.使用SpringBoot;"></a>1.使用SpringBoot;</h2><ul>
<li>创建SpringBoot应用，选中我们需要的模块（web，SQL(MyBatis)，noSQL(Redis，MongoDB)）</li>
<li>SpringBoot默认将这些模块配置好</li>
<li>自己编写业务代码</li>
</ul>
<p>自动配置原理</p>
<p>该场景SpringBoot帮我们配置了什么？能不能修改？能修改哪些配置？能不能扩展？…</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XXXAutoConfiguration;<span class="comment">//给容器中自动配置组件</span></span><br><span class="line">XXX.properties;<span class="comment">//配置文件</span></span><br></pre></td></tr></table></figure>

<h2 id="2-SpringBoot对静态资源的映射规则"><a href="#2-SpringBoot对静态资源的映射规则" class="headerlink" title="2.SpringBoot对静态资源的映射规则"></a>2.SpringBoot对静态资源的映射规则</h2><h3 id="1-webjars-http-www-webjars-org"><a href="#1-webjars-http-www-webjars-org" class="headerlink" title="1.webjars(http://www.webjars.org)"></a>1.webjars(<a target="_blank" rel="noopener" href="http://www.webjars.org/">http://www.webjars.org</a>)</h3><p>将用到的前端框架(jquery,BootStrap…)以maven的形式给出,比如此处引用jquery：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>所有**/webjars/****相关的请求都去以下地址找：/META-INF/resources/webjars/</li>
</ul>
<p>![屏幕快照 2020-10-28 16.34.31](/Users/wjtang/Pictures/屏幕快照 2020-10-28 16.34.31.png)</p>
<p>比如此处的jquery，访问地址为：localhost:8080/webjars/jquery/3.5.1/jquery.js</p>
<p>![屏幕快照 2020-10-28 16.44.37](/Users/wjtang/Pictures/屏幕快照 2020-10-28 16.44.37.png)</p>
<ul>
<li>“/**”访问当前项目的任何静态资源，路径如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;/META-INF/resources/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/resources/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/static/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/public/</span></span><br><span class="line"><span class="string">&quot;</span>/<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>欢迎页面</strong>：静态资源文件夹（resources）下的所有index.html页面；被“/**”映射</p>
</li>
<li><p>配置喜欢的<strong>图标</strong>（命名为favicon.icon）:也放在resources下，/**/favicon.icon都可被访问</p>
</li>
<li><p><strong>自定义静态资源文件夹路径</strong>,在配置文件中添加如下配置：</p>
</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.resources.static-locations</span>=<span class="string">classpath:/hello,classpath:/atguigu</span></span><br></pre></td></tr></table></figure>

<h2 id="3-模版引擎"><a href="#3-模版引擎" class="headerlink" title="3.模版引擎"></a>3.模版引擎</h2><p>模版引擎（如JSP,Velocity,Freemarker,Thymeleaf…）的作用（将Data和html结合，生成最终的页面），如下图：</p>
<p>![屏幕快照 2020-10-29 09.00.20](/Users/wjtang/Pictures/屏幕快照 2020-10-29 09.00.20.png)</p>
<p><strong>Thymeleaf</strong> (SpringBoot推荐)，语法更简单，功能更强大；</p>
<h3 id="1-引用Thymeleaf"><a href="#1-引用Thymeleaf" class="headerlink" title="1.引用Thymeleaf"></a>1.引用Thymeleaf</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Thymeleaf的使用-amp-语法"><a href="#2-Thymeleaf的使用-amp-语法" class="headerlink" title="2.Thymeleaf的使用&amp;语法"></a>2.Thymeleaf的使用&amp;语法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">&quot;classpath:/templates/&quot;</span>;<span class="comment">//默认前缀（SpringMVC中的prefix）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">&quot;.html&quot;</span>;<span class="comment">//默认后缀</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> checkTemplate = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> checkTemplateLocation = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> String prefix = <span class="string">&quot;classpath:/templates/&quot;</span>;<span class="comment">//html文件默认存放的路径</span></span><br><span class="line">    <span class="keyword">private</span> String suffix = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String mode = <span class="string">&quot;HTML&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Charset encoding;</span><br><span class="line">  <span class="comment">//只要将html文件放入classpath:/templates/中，thymeleaf就可以直接识别并渲染</span></span><br></pre></td></tr></table></figure>

<h4 id="1-使用方法"><a href="#1-使用方法" class="headerlink" title="1.使用方法"></a>1.使用方法</h4><ul>
<li>导入thymeleaf的名称空间（在html中）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用thymeleaf语法</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--一个简单的使用thymeleaf的 html sample--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Test of thymeleaf<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">成功！</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;hello&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--设置div的文本内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>1）使用<strong>th</strong>来设置或<strong>替换</strong><div>的各个属性，具体用法可在thymeleaf官方参考文档中找到</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- th:id 可以替换原有的 id=&quot;div01&quot;,th:text可设置这个&lt;div&gt;显示的文本--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div01&quot;</span> <span class="attr">class</span>=<span class="string">&quot;myDiv&quot;</span> <span class="attr">th:id</span>=<span class="string">&quot;$&#123;hello&#125;&quot;</span> <span class="attr">th:class</span>=<span class="string">&quot;$&#123;hello&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;hello&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2)<strong>表达式</strong>,在thymeleaf官方参考文档中（4.Standard Expression Syntax）可找到</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Simple</span> <span class="string">expressions:</span></span><br><span class="line"><span class="attr">Variable</span> <span class="string">Expressions: $&#123;...&#125; //获取变量值；OGNL语法；</span></span><br><span class="line">															<span class="attr">功能：1）获取变量的值，调用方法</span></span><br><span class="line">																	 <span class="meta">2）获取内置的基本对象：Expression</span> <span class="string">Basic Objects</span></span><br><span class="line"><span class="comment">																	  #ctx: the context object.</span></span><br><span class="line"><span class="comment">                                    #vars: the context variables.</span></span><br><span class="line"><span class="comment">                                    #locale: the context locale.</span></span><br><span class="line"><span class="comment">                                    #request: (only in Web Contexts) the HttpServletRequest object.</span></span><br><span class="line"><span class="comment">                                    #response: (only in Web Contexts) the HttpServletResponse object.</span></span><br><span class="line"><span class="comment">                                    #session: (only in Web Contexts) the HttpSession object.</span></span><br><span class="line"><span class="comment">                                    #servletContext: (only in Web Contexts) the ServletContext object.</span></span><br><span class="line">                                    <span class="meta">3)内置的工具对象：Expression</span> <span class="string">Utility Objects</span></span><br><span class="line"><span class="comment">                                    #execInfo: information about the template being processed.</span></span><br><span class="line"><span class="comment">                                    #messages: methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using #&#123;…&#125; syntax.</span></span><br><span class="line"><span class="comment">                                    #uris: methods for escaping parts of URLs/URIs</span></span><br><span class="line"><span class="comment">                                    #conversions: methods for executing the configured conversion service (if any).</span></span><br><span class="line"><span class="comment">                                    #dates: methods for java.util.Date objects: formatting, component extraction, etc.</span></span><br><span class="line"><span class="comment">                                    #calendars: analogous to #dates, but for java.util.Calendar objects.等等</span></span><br><span class="line">                                </span><br><span class="line">							</span><br><span class="line"><span class="attr">Selection</span> <span class="string">Variable Expressions: *&#123;...&#125;</span></span><br><span class="line"><span class="attr">Message</span> <span class="string">Expressions: #&#123;...&#125;</span></span><br><span class="line"><span class="attr">Link</span> <span class="string">URL Expressions: @&#123;...&#125;</span></span><br><span class="line"><span class="attr">Fragment</span> <span class="string">Expressions: ~&#123;...&#125;</span></span><br><span class="line"><span class="attr">Literals</span></span><br><span class="line"><span class="attr">Text</span> <span class="string">literals: &#x27;one text&#x27;, &#x27;Another one!&#x27;,…</span></span><br><span class="line"><span class="attr">Number</span> <span class="string">literals: 0, 34, 3.0, 12.3,…</span></span><br><span class="line"><span class="attr">Boolean</span> <span class="string">literals: true, false</span></span><br><span class="line"><span class="attr">Null</span> <span class="string">literal: null</span></span><br><span class="line"><span class="attr">Literal</span> <span class="string">tokens: one, sometext, main,…</span></span><br><span class="line"><span class="attr">Text</span> <span class="string">operations:</span></span><br><span class="line"><span class="attr">String</span> <span class="string">concatenation: +</span></span><br><span class="line"><span class="attr">Literal</span> <span class="string">substitutions: |The name is $&#123;name&#125;|</span></span><br><span class="line"><span class="attr">Arithmetic</span> <span class="string">operations:</span></span><br><span class="line"><span class="attr">Binary</span> <span class="string">operators: +, -, *, /, %</span></span><br><span class="line"><span class="attr">Minus</span> <span class="string">sign (unary operator): -</span></span><br><span class="line"><span class="attr">Boolean</span> <span class="string">operations:</span></span><br><span class="line"><span class="attr">Binary</span> <span class="string">operators: and, or</span></span><br><span class="line"><span class="attr">Boolean</span> <span class="string">negation (unary operator): !, not</span></span><br><span class="line"><span class="attr">Comparisons</span> <span class="string">and equality:</span></span><br><span class="line"><span class="attr">Comparators</span>: <span class="string">&gt;, &lt;, &gt;=, &lt;= (gt, lt, ge, le)</span></span><br><span class="line"><span class="attr">Equality</span> <span class="string">operators: ==, != (eq, ne)</span></span><br><span class="line"><span class="attr">Conditional</span> <span class="string">operators:</span></span><br><span class="line"><span class="meta">If-then</span>: <span class="string">(if) ? (then)</span></span><br><span class="line"><span class="meta">If-then-else</span>: <span class="string">(if) ? (then) : (else)</span></span><br><span class="line"><span class="attr">Default</span>: <span class="string">(value) ?: (defaultvalue)</span></span><br><span class="line"><span class="attr">Special</span> <span class="string">tokens:</span></span><br><span class="line"><span class="meta">No-Operation</span>: <span class="string">_</span></span><br></pre></td></tr></table></figure>

<h2 id="4-对SpringMVC的自动配置"><a href="#4-对SpringMVC的自动配置" class="headerlink" title="4.对SpringMVC的自动配置"></a>4.对SpringMVC的自动配置</h2><ul>
<li>当开发web应用（Developing Web Applications）时，SpingBoot对SpringMVC做了大量自动配置（WebMvcAutoConfiguration.class）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7.1</span>.<span class="number">1.</span> Spring MVC Auto-configuration</span><br><span class="line">Spring Boot provides auto-configuration <span class="keyword">for</span> Spring MVC that works well with most applications.</span><br><span class="line"></span><br><span class="line">The auto-configuration adds the following features on top of Spring’s defaults:</span><br><span class="line"></span><br><span class="line">Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.</span><br><span class="line"></span><br><span class="line">Support <span class="keyword">for</span> serving <span class="keyword">static</span> resources, <span class="function">including support <span class="keyword">for</span> <span class="title">WebJars</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>).</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Automatic registration of Converter, GenericConverter, and Formatter beans.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Support <span class="keyword">for</span> <span class="title">HttpMessageConverters</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Automatic registration of <span class="title">MessageCodesResolver</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Static index.html support.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Custom Favicon <span class="title">support</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Automatic use of a ConfigurableWebBindingInitializer <span class="title">bean</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">If you want to keep those Spring Boot MVC customizations and make more MVC <span class="title">customizations</span> <span class="params">(interceptors, formatters, view controllers, and other features)</span>, you can add your own @Configuration class of type WebMvcConfigurer but without @EnableWebMvc. <span class="comment">//1.在默认配置基础上扩展配置;</span></span></span><br><span class="line"><span class="function">  <span class="comment">//[注]：class of type WebMvcConfigurer 指这个class要继承WebMvcConfigurer</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">If you want to provide custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or ExceptionHandlerExceptionResolver, and still keep the Spring Boot MVC customizations, you can declare a bean of type WebMvcRegistrations and use it to provide custom instances of those components.<span class="comment">//2.在默认配置基础上扩展配置</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">If you want to take complete control of Spring MVC, you can add your own @Configuration annotated with @EnableWebMvc, or alternatively add your own @Configuration-annotated DelegatingWebMvcConfiguration as described in the Javadoc of @EnableWebMvc.<span class="comment">//3.替换原有配置</span></span></span><br></pre></td></tr></table></figure>

<p>【注】：以上配置都是从SpringBoot官方文档中找到的</p>
<ul>
<li>在默认配置基础上扩展配置，可以写一个SpringBoot配置类，示例如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 在默认配置基础上扩展配置</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ctrl+o 找出当前可以重写的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/atguigu&quot;</span>).setViewName(<span class="string">&quot;/success&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-如何修改SpringBoot的默认配置"><a href="#5-如何修改SpringBoot的默认配置" class="headerlink" title="5.如何修改SpringBoot的默认配置"></a>5.如何修改SpringBoot的默认配置</h2><p>模式：</p>
<ul>
<li><p>SpringBoot在自动配置很多组件时，会先看下容器中有没有用户自己配置的组件（@Bean,@Component），<strong>优先</strong>使用或<strong>合并</strong>使用用户配置；</p>
</li>
<li><p>在SpringBoot中会有很多xxxConfiguration.class帮助我们进行扩展配置；</p>
</li>
</ul>
<h2 id="6-Restful"><a href="#6-Restful" class="headerlink" title="6.Restful"></a>6.Restful</h2><h3 id="1-默认访问首页："><a href="#1-默认访问首页：" class="headerlink" title="1.默认访问首页："></a>1.默认访问首页：</h3><p>在controller中写入如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index.html&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-国际化"><a href="#2-国际化" class="headerlink" title="2.国际化"></a>2.国际化</h3><p>国际化：网页的语言根据浏览器语言自动改变 or 点击页面某个按钮切换语言；</p>
<ul>
<li><p>SpringMVC方式</p>
<ul>
<li>编写国际化配置文件</li>
<li>使用ResourceBundleMessageResource管理国际化资源文件</li>
<li>在页面使用fmt:message取出国际化内容</li>
</ul>
</li>
<li><p>SpringBoot方式</p>
<ul>
<li><p>编写国际化配置文件，抽取页面需要显示的国际化消息![屏幕快照 2020-11-01 11.58.39](/Users/wjtang/Pictures/屏幕快照 2020-11-01 11.58.39.png)</p>
</li>
<li><p>SpringBoot自动配置好了管理国际化配置文件的组件</p>
</li>
<li><p>application.properties文件中添加如下配置：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.messages.basename</span>=<span class="string">i18n.login</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>页面获取国际化配置文件中的值，实现<strong>根据浏览器语言自动切换网页语言</strong></p>
</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;form</span> <span class="string">class=&quot;form-signin&quot; action=&quot;dashboard.html&quot;&gt;</span></span><br><span class="line">			<span class="meta">&lt;img</span> <span class="string">class=&quot;mb-4&quot; th:src=&quot;@&#123;asserts/img/bootstrap-solid.svg&#125;&quot; src=&quot;asserts/img/bootstrap-solid.svg&quot; alt=&quot;&quot; width=&quot;72&quot; height=&quot;72&quot;&gt;</span></span><br><span class="line">			<span class="meta">&lt;h1</span> <span class="string">class=&quot;h3 mb-3 font-weight-normal&quot; th:text=&quot;#&#123;login.tip&#125;&quot;&gt;Please sign in&lt;/h1&gt;</span></span><br><span class="line">			<span class="meta">&lt;label</span> <span class="string">class=&quot;sr-only&quot; th:text=&quot;#&#123;login.username&#125;&quot;&gt;Username&lt;/label&gt;</span></span><br><span class="line">			<span class="meta">&lt;input</span> <span class="string">type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; th:placeholder=&quot;#&#123;login.username&#125;&quot; required=&quot;&quot; autofocus=&quot;&quot;&gt;</span></span><br><span class="line">			<span class="meta">&lt;label</span> <span class="string">class=&quot;sr-only&quot; th:text=&quot;#&#123;login.password&#125;&quot;&gt;Password&lt;/label&gt;</span></span><br><span class="line">			<span class="meta">&lt;input</span> <span class="string">type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; th:placeholder=&quot;#&#123;login.password&#125;&quot; required=&quot;&quot;&gt;</span></span><br><span class="line">			<span class="meta">&lt;div</span> <span class="string">class=&quot;checkbox mb-3&quot;&gt;</span></span><br><span class="line">				<span class="attr">&lt;label&gt;</span></span><br><span class="line">          <span class="meta">&lt;input</span> <span class="string">type=&quot;checkbox&quot; value=&quot;remember-me&quot;/&gt; [[#&#123;login.remember&#125;]] &lt;!--这里特殊（这是个单选框），要注意--&gt;</span></span><br><span class="line">        <span class="attr">&lt;/label&gt;</span></span><br><span class="line">			<span class="attr">&lt;/div&gt;</span></span><br><span class="line">			<span class="meta">&lt;button</span> <span class="string">class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; th:text=&quot;#&#123;login.btn&#125;&quot;&gt;Sign in&lt;/button&gt;</span></span><br><span class="line">			<span class="meta">&lt;p</span> <span class="string">class=&quot;mt-5 mb-3 text-muted&quot;&gt;© 2017-2018&lt;/p&gt;</span></span><br><span class="line">			<span class="meta">&lt;a</span> <span class="string">class=&quot;btn btn-sm&quot;&gt;中文&lt;/a&gt;</span></span><br><span class="line">			<span class="meta">&lt;a</span> <span class="string">class=&quot;btn btn-sm&quot;&gt;English&lt;/a&gt;</span></span><br><span class="line">		<span class="attr">&lt;/form&gt;</span></span><br><span class="line">		</span><br><span class="line"><span class="meta">&lt;!--</span>	<span class="string">th:text=&quot;#&#123;login.username&#125;,th:placeholder=&quot;#&#123;login.password&#125;,[[#&#123;login.remember&#125;]] 实现了获取国际化配置文件的值		--&gt; </span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>点击网页按钮切换语言</strong></p>
<p>1）在html中配置好切换语言按钮的 超链接&amp;参数（如zh_CN，代表语言_国家）</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;a</span> <span class="string">class=&quot;btn btn-sm&quot; th:href=&quot;@&#123;/login.html(l=&#x27;zh_CN&#x27;)&#125;&quot;&gt;中文&lt;/a&gt;</span></span><br><span class="line"><span class="meta">&lt;a</span> <span class="string">class=&quot;btn btn-sm&quot; th:href=&quot;@&#123;/login.html(l=&#x27;en_US&#x27;)&#125;&quot;&gt;English&lt;/a&gt;</span></span><br><span class="line"><span class="meta">&lt;!--</span> <span class="string">没有模版引擎时，参数：login.html@l=zh_CN</span></span><br><span class="line">	 <span class="meta">有模版引擎之后，参数：login.html(l</span>=<span class="string">&#x27;zh_CN&#x27;)--&gt;</span></span><br></pre></td></tr></table></figure>

<p>​            2）写一个“语言解析类”，解析前端传来的参数如zh_CN：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.LocaleResolver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 自己配置的&quot;语言解析类&quot;</span></span><br><span class="line"><span class="comment">* 实现点击网页按钮切换显示语言功能</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocaleResolver</span> <span class="keyword">implements</span> <span class="title">LocaleResolver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Locale <span class="title">resolveLocale</span><span class="params">(HttpServletRequest httpServletRequest)</span> </span>&#123;</span><br><span class="line">        String languange = httpServletRequest.getParameter(<span class="string">&quot;l&quot;</span>);<span class="comment">//获取前端传来的参数，如zh_CN</span></span><br><span class="line">        Locale locale = Locale.getDefault();<span class="comment">//如果参数为空，使用浏览器默认语言</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(languange))&#123; <span class="comment">//参数不空，则解析，并使用参数所代表的语言</span></span><br><span class="line">            String split[] = languange.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">            locale = <span class="keyword">new</span> Locale(split[<span class="number">0</span>],split[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> locale; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocale</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Locale locale)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    3）在SpringBoot配置类中注册MyLocaleResolver（@Bean）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/在SpringBoot配置类中添加组件，加载我们自己配置的<span class="string">&quot;语言解析类&quot;</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">new</span> MyLocaleResolver();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-登录"><a href="#3-登录" class="headerlink" title="3.登录"></a>3.登录</h3><h4 id="1）热部署"><a href="#1）热部署" class="headerlink" title="1）热部署"></a>1）热部署</h4><ul>
<li>关闭thymeleaf缓存(在application.properties中添加配置)</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#禁用thymeleaf的缓存</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Ctrl+F9 / Command+Shift+F9  修改页面后，此快捷键可以重新编译</li>
</ul>
<h4 id="2）处理登录请求"><a href="#2）处理登录请求" class="headerlink" title="2）处理登录请求"></a>2）处理登录请求</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@RequestMapping(value = &quot;/user/login&quot;,method = RequestMethod.POST) =  @PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span>String username,</span></span></span><br><span class="line"><span class="function"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span>String password,</span></span></span><br><span class="line"><span class="function"><span class="params">                        Map&lt;String,Object&gt; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username)&amp;&amp;password.equals(<span class="string">&quot;123456&quot;</span>))&#123;<span class="comment">//登录成功返回主页</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;dashboard&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户名密码错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;<span class="comment">//登录失败，返回登录页面，并附带登录失败的信息msg</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>login.html中显示登录失败的信息（登录验证不通过时）：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&lt;!--登录失败时显示--&gt;</span></span><br><span class="line"><span class="meta">&lt;p</span> <span class="string">style=&quot;color: red&quot; th:text=&quot;$&#123;msg&#125;&quot; th:if=&quot;$&#123;not #strings.isEmpty(msg)&#125;&quot;&gt;&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-css样式丢失的问题"><a href="#3-css样式丢失的问题" class="headerlink" title="3)  css样式丢失的问题"></a>3)  css样式丢失的问题</h4><p><strong>首先</strong>，登录失败重返登录页面后，可能会css样式丢失</p>
<p>原因：路径问题</p>
<p>解决方案：加上一个/，则使用绝对路径，即localhost:8080+显示网页源代码中的路径；</p>
<p>如果还不行，转到下面的【注2】；</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#th:href=&quot;@&#123;asserts/css/signin.css&#125; #加上/ ，变成下面的配置</span></span><br><span class="line"><span class="attr">th</span>:<span class="string">href=&quot;@&#123;/asserts/css/signin.css&#125;</span></span><br></pre></td></tr></table></figure>

<p>【注】：图标丢失也是一样的问题，一样的解决方案；</p>
<p>【注2】：显示网页源码；点击xxx.css文件;在浏览器地址栏直接修改地址，观察哪个地址可以访问到，做相应修改；</p>
<p> <strong>其次</strong>，提交登录后，进入主页面，主页面可能会css样式丢失；</p>
<ul>
<li>重定向处理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@RequestMapping(value = &quot;/user/login&quot;,method = RequestMethod.POST) =  @PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span>String username,</span></span></span><br><span class="line"><span class="function"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span>String password,</span></span></span><br><span class="line"><span class="function"><span class="params">                        Map&lt;String,Object&gt; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username)&amp;&amp;password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">//return &quot;dashboard&quot;; //登录成功返回主页</span></span><br><span class="line">          	<span class="comment">//------------------</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/main.html&quot;</span>;<span class="comment">//防止表单重复提交，可以重定向到主页</span></span><br><span class="line">          <span class="comment">//--------------------</span></span><br><span class="line">          </span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户名密码错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>; <span class="comment">//登录失败，返回登录页面，并附带登录失败的信息msg</span></span><br><span class="line">            <span class="comment">//return &quot;redirect:/loginFail&quot;;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在SpringBoot配置类（MyMvcConfig）加如下代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ctrl+o 找出当前可以重写的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/atguigu&quot;</span>).setViewName(<span class="string">&quot;/success&quot;</span>);</span><br><span class="line">      <span class="comment">//---------------</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/main.html&quot;</span>).setViewName(<span class="string">&quot;dashboard&quot;</span>);</span><br><span class="line">      <span class="comment">//---------------</span></span><br><span class="line">        <span class="comment">//registry.addViewController(&quot;/loginFail&quot;).setViewName(&quot;login&quot;);</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="4）拦截器"><a href="#4）拦截器" class="headerlink" title="4）拦截器"></a>4）拦截器</h4><ul>
<li>在LoginController中添加  HttpSession session 并且将刚刚登录的用户放到session中</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@RequestMapping(value = &quot;/user/login&quot;,method = RequestMethod.POST) =  @PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span>String username,</span></span></span><br><span class="line"><span class="function"><span class="params">                        <span class="meta">@RequestParam(&quot;password&quot;)</span>String password,</span></span></span><br><span class="line"><span class="function"><span class="params">                        Map&lt;String,Object&gt; map,</span></span></span><br><span class="line"><span class="function"><span class="params">                        HttpSession session)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(username)&amp;&amp;password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">//return &quot;dashboard&quot;; //登录成功返回主页</span></span><br><span class="line">          </span><br><span class="line">            session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,username);</span><br><span class="line">          </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/main.html&quot;</span>;<span class="comment">//防止表单重复提交，可以重定向到主页</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户名密码错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>; <span class="comment">//登录失败，返回登录页面，并附带登录失败的信息msg</span></span><br><span class="line">            <span class="comment">//return &quot;redirect:/loginFail&quot;;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写拦截器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 拦截器，</span></span><br><span class="line"><span class="comment">* 登录检查</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Object user = request.getSession().getAttribute(<span class="string">&quot;loginUser&quot;</span>);<span class="comment">//从session中获取用户</span></span><br><span class="line">        <span class="keyword">if</span> (user == <span class="keyword">null</span>)&#123;<span class="comment">//未登录</span></span><br><span class="line">            request.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;没有权限登录&quot;</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">&quot;/login.html&quot;</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;<span class="comment">//已登录</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注册拦截器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  * 注册拦截器，使之生效</span></span><br><span class="line"><span class="comment">  * 防止越过登录非法访问</span></span><br><span class="line"><span class="comment">  * */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">      registry.addInterceptor(<span class="keyword">new</span> LoginHandlerInterceptor()).addPathPatterns(<span class="string">&quot;/**&quot;</span>)<span class="comment">//代表对所有路径进行拦截</span></span><br><span class="line">      .excludePathPatterns(<span class="string">&quot;/login.html&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;/user/login&quot;</span>,<span class="string">&quot;/asserts/**&quot;</span>,<span class="string">&quot;/webjars/**&quot;</span>);<span class="comment">//有些路径和静态资源不拦截</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>【注】：有些路径和静态资源不能拦截，否则连登录都无法完成；SpringBoot2.0默认对静态资源拦截，要手动使其不拦截需要的文件；</p>
<h3 id="4-CRUD-用户列表功能"><a href="#4-CRUD-用户列表功能" class="headerlink" title="4.CRUD-用户列表功能"></a>4.CRUD-用户列表功能</h3><p>实验要求：</p>
<h4 id="1-RestfulCRUD-CRUD满足restful风格；"><a href="#1-RestfulCRUD-CRUD满足restful风格；" class="headerlink" title="1) RestfulCRUD:CRUD满足restful风格；"></a>1) RestfulCRUD:CRUD满足restful风格；</h4><p>URL：/资源名称/资源标识；通过“HTTP请求方式”来区分对资源CRUD操作</p>
<table>
<thead>
<tr>
<th></th>
<th>CRUD</th>
<th>RestfulCRUD</th>
</tr>
</thead>
<tbody><tr>
<td>查询</td>
<td>getEmp</td>
<td>emp-GET</td>
</tr>
<tr>
<td>添加</td>
<td>addEmp?xxx</td>
<td>emp-POST</td>
</tr>
<tr>
<td>修改</td>
<td>updateEmp?id=xxx&amp;name=xxx</td>
<td>emp/{id}-PUT</td>
</tr>
<tr>
<td>删除</td>
<td>deleteEmp?id=xxx</td>
<td>emp/{id}-DELETE</td>
</tr>
</tbody></table>
<h4 id="2-实验的请求架构"><a href="#2-实验的请求架构" class="headerlink" title="2) 实验的请求架构"></a>2) 实验的请求架构</h4><table>
<thead>
<tr>
<th></th>
<th>请求URL</th>
<th>请求方式</th>
</tr>
</thead>
<tbody><tr>
<td>查询所有员工</td>
<td>emps</td>
<td>GET</td>
</tr>
<tr>
<td>查询单个员工</td>
<td>emp/{id}</td>
<td>GET</td>
</tr>
<tr>
<td>来到添加页面</td>
<td>emp</td>
<td>GET</td>
</tr>
<tr>
<td>添加员工</td>
<td>emp</td>
<td>POST</td>
</tr>
<tr>
<td>来到修改页面</td>
<td>emp/{id}</td>
<td>GET</td>
</tr>
<tr>
<td>修改员工信息</td>
<td>emp</td>
<td>PUT</td>
</tr>
<tr>
<td>删除员工</td>
<td>emp/{id}</td>
<td>DELETE</td>
</tr>
</tbody></table>
<h4 id="3-员工列表"><a href="#3-员工列表" class="headerlink" title="3) 员工列表"></a>3) 员工列表</h4><h5 id="抽取页面公共元素"><a href="#抽取页面公共元素" class="headerlink" title="抽取页面公共元素"></a><strong>抽取页面公共元素</strong></h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line">#1.抽取公共片段</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:fragment</span>=<span class="string">&quot;copy&quot;</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line">#2.引入公共片段</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;footer :: copy&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> #~&#123;&#125; 可以省略; footer是1.公共片段的文件名（footer.html）</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">【注】：样例代码 来自于 thymeleaf官网</span><br></pre></td></tr></table></figure>

<p>示例如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#1.在dashboard.html，抽取公共片段topbar</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0&quot;</span> <span class="attr">th:fragment</span>=<span class="string">&quot;topbar&quot;</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">#2.在list.html中，引入公共片段</span><br><span class="line">    <span class="comment">&lt;!--		引入抽取的topbar--&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--		模版名：会使用thymeleaf的前后缀配置规则进行解析--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;dashboard::topbar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>#3.最终效果，点击下图1处，2不会变化（不做公共片段，则2会变化）</p>
<p>![屏幕快照 2020-11-03 10.11.01](/Users/wjtang/Pictures/屏幕快照 2020-11-03 10.11.01.png)</p>
<p>实际上，thymeleaf包含三种配置“页面公共元素”的方式</p>
<ul>
<li><code>th:insert</code> is the simplest: it will simply insert the specified fragment as the body of its host tag.</li>
<li><code>th:replace</code> actually <em>replaces</em> its host tag with the specified fragment.</li>
<li><code>th:include</code> is similar to <code>th:insert</code>, but instead of inserting the fragment it only inserts the <em>contents</em> of this fragment.</li>
</ul>
<p>不用<code>th:fragment</code>实现引用公共元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#1.指明公共元素 的id</span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;copy-section&quot;</span>&gt;</span></span><br><span class="line">  <span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">#2.在另一个页面引用这个 id</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;footer :: #copy-section&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">【注】：样例代码 来自于 thymeleaf官网</span><br></pre></td></tr></table></figure>

<p>示例如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#在dashboard.html中指定 侧边栏（公共元素）的id</span><br><span class="line">				<span class="comment">&lt;!--				指明 侧边栏（公共元素）的id--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;col-md-2 d-none d-md-block bg-light sidebar&quot;</span> <span class="attr">id</span>=<span class="string">&quot;sidebar&quot;</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">#2.在list.html中 引用这个 id</span><br><span class="line">         <span class="comment">&lt;!--				删除之前的 nav--&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--				引入侧边栏,通过id的方式 #id--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;dashboard::#sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>最终效果如下：点击“员工管理”，侧边栏不发生变化（不做上面的操作则会变化）</p>
<p>![屏幕快照 2020-11-03 11.00.58](/Users/wjtang/Pictures/屏幕快照 2020-11-03 11.00.58.png)</p>
<h5 id="动态高亮"><a href="#动态高亮" class="headerlink" title="动态高亮"></a>动态高亮</h5><ul>
<li>首先将dashboard的topbar和sidebar独立出来放到commons/bar.html中</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入topbar--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0&quot;</span> <span class="attr">th:fragment</span>=<span class="string">&quot;topbar&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;navbar-brand col-sm-3 col-md-2 mr-0&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://getbootstrap.com/docs/4.0/examples/dashboard/#&quot;</span>&gt;</span>[[$&#123;session.loginUser&#125;]]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>

<ul>
<li>其次将dashboard.html中的topbar和sidebar<strong>替换</strong>为引用的方式；将其它引用到topbar和sidebar的位置作相应修改（list.html）；</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#1.在原topbar和sidebar的位置替换成引用的形式</span><br><span class="line"><span class="comment">&lt;!--	引入topbar--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;commons/bar::topbar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--		引入侧边栏 sidebar--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;commons/bar::#sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.其它用到topbar和sidebar的地方作修改（如此处的list.html）</span><br><span class="line"><span class="comment">&lt;!--		引入抽取的topbar--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--		模版名：会使用thymeleaf的前后缀配置规则进行解析--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/bar::topbar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--				引入侧边栏sidebar,通过id的方式 #id--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;commons/bar::#sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在bar.html的侧边栏（sidebar）添加如下判断</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">th:class=&quot;$&#123;activeUri==&#x27;main.html&#x27;?&#x27;nav-link active&#x27;:&#x27;nav-link&#x27;&#125;&quot; //此处对应于dashboard.html</span><br><span class="line">th:class=&quot;$&#123;activeUri==&#x27;emps&#x27;?&#x27;nav-link active&#x27;:&#x27;nav-link&#x27;&#125;&quot;  //此处对应于员工列表页面 list.html</span><br></pre></td></tr></table></figure>

<ul>
<li>最后在对应的页面（dashboard.html ，list.html）添加上参数；</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;commons/bar::#sidebar(activeUri=&#x27;main.html&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  //此处对应于dashboard.html</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;commons/bar::#sidebar(activeUri=&#x27;emps&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>   //此处对应于员工列表页面 list.html</span><br></pre></td></tr></table></figure>

<h5 id="修改list-html样式"><a href="#修改list-html样式" class="headerlink" title="修改list.html样式"></a>修改list.html样式</h5><ul>
<li>list.html展示的数据该成从后端获取来的（而不是写死在list.html中的）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#修改<span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span>中的数据项；</span><br><span class="line">#emps是处理后段Controller传过来的</span><br><span class="line">				<span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>lastName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>department<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>birth<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;emp:$&#123;emps&#125;&quot;</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.lastName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.gender&#125;==0?&#x27;男&#x27;:&#x27;女&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.department.departmentName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(emp.birth,&#x27;dd-MM-yyyy HH:mm&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">										<span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-primary&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">										<span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">									<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>页面效果展示：![屏幕快照 2020-11-03 14.39.52](/Users/wjtang/Pictures/屏幕快照 2020-11-03 14.39.52.png)</p>
<h4 id="4-员工添加"><a href="#4-员工添加" class="headerlink" title="4)员工添加"></a>4)员工添加</h4><h5 id="员工添加页面"><a href="#员工添加页面" class="headerlink" title="员工添加页面"></a>员工添加页面</h5><ul>
<li>list.html的按钮添加超链接</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>为超链接写后台</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/emp&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toAddPage</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">        Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">        model.addAttribute(<span class="string">&quot;depts&quot;</span>,departments);<span class="comment">//查出所有部门id，传到add.html</span></span><br><span class="line">      </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;emp/add&quot;</span>;<span class="comment">//返回add.html</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写员工添加页面add.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#主要是写好下面的form表单，其它的可以复制list.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">						<span class="comment">&lt;!--发送put请求修改员工数据--&gt;</span></span><br><span class="line">						<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">						1、SpringMVC中配置HiddenHttpMethodFilter;（SpringBoot自动配置好的）</span></span><br><span class="line"><span class="comment">						2、页面创建一个post表单</span></span><br><span class="line"><span class="comment">						3、创建一个input项，name=&quot;_method&quot;;值就是我们指定的请求方式</span></span><br><span class="line"><span class="comment">						--&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;emp!=null&#125;&quot;</span>/&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;emp!=null&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.id&#125;&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;zhangsan&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.lastName&#125;&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;zhangsan@atguigu.com&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.email&#125;&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.gender==1&#125;&quot;</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.gender==0&#125;&quot;</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>department<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="comment">&lt;!--提交的是部门的id--&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;dept.id == emp.department.id&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;dept.id&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;dept:$&#123;depts&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;dept.departmentName&#125;&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;zhangsan&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;#dates.format(emp.birth, &#x27;yyyy-MM-dd HH:mm&#x27;)&#125;&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp!=null&#125;?&#x27;修改&#x27;:&#x27;添加&#x27;&quot;</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="实现员工添加功能"><a href="#实现员工添加功能" class="headerlink" title="实现员工添加功能"></a>实现员工添加功能</h5><ul>
<li>首先配置form表单提交的地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>处理刚刚的地址（在Controller中）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/emp&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addEmp</span><span class="params">(Employee employee)</span></span>&#123;<span class="comment">//SpringMVC自动将 请求参数 封装到javaBean；（属性名name要一致）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;保存的员工信息：&quot;</span>+employee);</span><br><span class="line">        employeeDao.save(employee);</span><br><span class="line">        <span class="comment">//添加完成，返回员工列表页面;redirect：重定向；forward:转发到某个地址</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>【注】：SpringMVC自动将 form中的参数 封装到javaBean（此处的javaBean是形参）；（属性名name要一致）</p>
<p>【注2】：form中有日期时，默认用/（2019/10/03）；如果要改，在application.properties中配置;</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.format.date</span>=<span class="string">yyyy-MM-dd</span></span><br></pre></td></tr></table></figure>

<h4 id="5）修改员工"><a href="#5）修改员工" class="headerlink" title="5）修改员工"></a>5）修改员工</h4><h5 id="修改员工页面"><a href="#修改员工页面" class="headerlink" title="修改员工页面"></a>修改员工页面</h5><ul>
<li>仍使用add.html（添加员工页面）</li>
<li>编写Controller方法，处理编辑按钮对应的链接</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/emp/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toEditPage</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id,Model model)</span></span>&#123;</span><br><span class="line">        Employee employee = employeeDao.get(id);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;emp&quot;</span>,employee); <span class="comment">//将查出来的用户放到model里面供前端使用</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//查出所有部门id，在页面显示</span></span><br><span class="line">        Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">        model.addAttribute(<span class="string">&quot;depts&quot;</span>,departments);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/emp/add&quot;</span>;<span class="comment">//edit.html修改添加</span></span><br></pre></td></tr></table></figure>

<ul>
<li>添加判断，实现员工数据在编辑页面的回显</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;zhangsan&quot;</span> 	</span></span><br><span class="line"><span class="tag">                     <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.lastName&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;zhangsan@atguigu.com&quot;</span> </span></span><br><span class="line"><span class="tag">                     <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp!=null&#125;?$&#123;emp.email&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp!=null&#125;?&#x27;修改&#x27;:&#x27;添加&#x27;&quot;</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- th:value=&quot;$&#123;emp!=null&#125;?$&#123;emp.email&#125;&quot; 通过这个来判断--&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="实现修改员工操作"><a href="#实现修改员工操作" class="headerlink" title="实现修改员工操作"></a>实现修改员工操作</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">						<span class="comment">&lt;!--发送put请求修改员工数据--&gt;</span></span><br><span class="line">						<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">						1、SpringMVC中配置HiddenHttpMethodFilter;（配置：spring.mvc.hiddenmethod.filter.enabled=true）</span></span><br><span class="line"><span class="comment">						2、页面创建一个post表单</span></span><br><span class="line"><span class="comment">						3、创建一个input项，name=&quot;_method&quot;;值就是我们指定的请求方式(这里是put 代表修改)</span></span><br><span class="line"><span class="comment">						--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;emp!=null&#125;&quot;</span>/&gt;</span><span class="comment">&lt;!-- emp!=null，即修改员工时才生效 --&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>编写Controller方法处理put请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//PUT 修改</span></span><br><span class="line">  <span class="meta">@PutMapping(&quot;/emp&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">updateEmployee</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;修改的员工为&quot;</span>+employee);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-删除员工"><a href="#6-删除员工" class="headerlink" title="6) 删除员工"></a>6) 删除员工</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">				1、SpringMVC中配置HiddenHttpMethodFilter;（配置：spring.mvc.hiddenmethod.filter.enabled=true）</span></span><br><span class="line"><span class="comment">				2、页面创建一个post表单</span></span><br><span class="line"><span class="comment">				3、创建一个input项，name=&quot;_method&quot;;值就是我们指定的请求方式(这里是delete 代表删除)</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp/&#125;+$&#123;emp.id&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编写Controller方法处理delete请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DELETE 删除</span></span><br><span class="line">  <span class="meta">@DeleteMapping(&quot;/emp/&#123;id&#125;&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">deleteEmployee</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">      employeeDao.delete(id);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-错误处理机制"><a href="#7-错误处理机制" class="headerlink" title="7.错误处理机制"></a>7.错误处理机制</h2><h3 id="1-SpringBoot默认错误处理机制"><a href="#1-SpringBoot默认错误处理机制" class="headerlink" title="1. SpringBoot默认错误处理机制"></a>1. SpringBoot默认错误处理机制</h3><ul>
<li>返回一个默认的错误页面</li>
<li>若是某些客户端（如postman），返回json</li>
</ul>
<p>【注】：具体配置可参考ErrorMvcAutoConfiguration.class</p>
<h3 id="2-定制错误页面"><a href="#2-定制错误页面" class="headerlink" title="2.  定制错误页面"></a>2.  定制错误页面</h3><h4 id="1）如何定制错误页面"><a href="#1）如何定制错误页面" class="headerlink" title="1）如何定制错误页面"></a>1）如何定制错误页面</h4><ul>
<li>有模版引擎；<ul>
<li><strong>地址</strong>：<strong>templates/error/状态码.html</strong>;</li>
<li>支持模糊匹配，如4xx.html可以匹配所有4开头的状态码; 优先匹配精确的状态码</li>
<li>页面能获取的信息（可从DefaultErrorAttributes.class找）；<ul>
<li>timestamp ：时间戳</li>
<li>status ：状态码</li>
<li>error : 错误提示</li>
<li>exception ：异常</li>
<li>message : 异常消息</li>
<li>errors ：JSR303数据校验的错误都在这里</li>
</ul>
</li>
</ul>
</li>
<li>没有模版引擎<ul>
<li>地址 : static/error/状态码.html；</li>
<li>支持模糊匹配</li>
<li>变量无法获取（timestamp、status…）</li>
</ul>
</li>
<li>template和static下都没有错误页面<ul>
<li>使用SpringBoot默认的错误页面</li>
</ul>
</li>
</ul>
<p>下面给出具体配置方法</p>
<ul>
<li><p>自定义Exception类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.exception; <span class="comment">//这里新建了exception文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserNotExistException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserNotExistException</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;用户不存在&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用上面的Exception类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ResponseBody返回纯文本</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(<span class="meta">@RequestParam(&quot;user&quot;)</span>String user)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(user.equals(<span class="string">&quot;aaa&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UserNotExistException(); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello Spring web!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在html中写入需要输出的信息（此处为4xx.html）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">main</span> <span class="attr">role</span>=<span class="string">&quot;main&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-md-9 ml-sm-auto col-lg-10 pt-3 px-4&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h1</span>&gt;</span>status:[[$&#123;status&#125;]]<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h2</span>&gt;</span>timestamp:[[$&#123;timestamp&#125;]]<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果用到页面可获取的信息（如message , exception…）</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加如下配置</span></span><br><span class="line"><span class="meta">server.error.include-exception</span>=<span class="string">true</span></span><br><span class="line"><span class="meta">server.error.include-message</span>=<span class="string">always</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<ul>
<li>地址： <a target="_blank" rel="noopener" href="http://localhost:8080/crud/hello?user=aaa">http://localhost:8080/crud/hello?user=aaa</a></li>
</ul>
</li>
</ul>
<p>【注】：此时实现的是浏览器返回html，Postman返回json；其中html可以定制，但是json目前还不能定制；</p>
<h4 id="2）如何定制错误json提示"><a href="#2）如何定制错误json提示" class="headerlink" title="2）如何定制错误json提示"></a>2）如何定制错误json提示</h4><ul>
<li><p>浏览器和客户端都返回json</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.controller;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义一个ExceptionHandler</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExceptionHandler</span> </span>&#123;</span><br><span class="line">      <span class="comment">//1.浏览器和客户端都返回json</span></span><br><span class="line">      <span class="meta">@ResponseBody</span></span><br><span class="line">      <span class="meta">@ExceptionHandler(UserNotExistException.class)</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">handleException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">          Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">          map.put(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;user.notexist&quot;</span>);</span><br><span class="line">          map.put(<span class="string">&quot;message&quot;</span>,e.getMessage());</span><br><span class="line">          <span class="keyword">return</span> map;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自适应效果：浏览器html，客户端显示json；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.实现自适应；浏览器返回html，客户端返回json</span></span><br><span class="line"><span class="meta">@ExceptionHandler(UserNotExistException.class)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">handleException</span><span class="params">(Exception e, HttpServletRequest request)</span></span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//传入我们自己的错误状态码 4xx 5xx</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;javax.servlet.error.status_code&quot;</span>,<span class="number">500</span>);</span><br><span class="line">    map.put(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;user.notexist&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;message&quot;</span>,e.getMessage());</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">//配合下一步</span></span><br><span class="line">  	request.setAttribute(<span class="string">&quot;extra&quot;</span>,map);<span class="comment">//将需要显示的错误信息放到request中，供MyErrorAttributes调用</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/error&quot;</span>;<span class="comment">//转发到/error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>【注】：此处的“自适应效果”，json还是不能定制；若要实现json的定制，需要自定义如下ErrorAttributes</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.component;<span class="comment">//此处放在component包下</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//给容器中加入自己定义的ErrorAttributes</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyErrorAttributes</span> <span class="keyword">extends</span> <span class="title">DefaultErrorAttributes</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getErrorAttributes</span><span class="params">(WebRequest webRequest, ErrorAttributeOptions options)</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">super</span>.getErrorAttributes(webRequest, options);</span><br><span class="line">        map.put(<span class="string">&quot;company&quot;</span>,<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line">        Map&lt;String,Object&gt; extra = (Map&lt;String, Object&gt;) webRequest.getAttribute(<span class="string">&quot;extra&quot;</span>,<span class="number">0</span>);<span class="comment">//0代表从request域中获取数据</span></span><br><span class="line">        map.put(<span class="string">&quot;extra&quot;</span>,extra);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="8-配置嵌入式Servlet容器"><a href="#8-配置嵌入式Servlet容器" class="headerlink" title="8.配置嵌入式Servlet容器"></a>8.配置嵌入式Servlet容器</h2><p>SpringBoot默认使用的是嵌入式的Servlet容器；</p>
<p>【注】：Tomcat就是一个Servlet容器</p>
<h4 id="1-定制和修改Servlet相关配置"><a href="#1-定制和修改Servlet相关配置" class="headerlink" title="1. 定制和修改Servlet相关配置"></a>1. 定制和修改Servlet相关配置</h4><ul>
<li><p>方法1：修改和server有关的配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.servlet.context-path</span>=<span class="string">/crud</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="attr">...</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2：在配置类（@Configuration）编写一个EmbeddedServletContainerCustomizer(Spring 2.0版本以上用：WebServerFactoryCustomizer)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt; <span class="title">configurableWebServerFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(ConfigurableWebServerFactory factory)</span> </span>&#123;</span><br><span class="line">            factory.setPort(<span class="number">8083</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>【注】：建议使用方法1；方便快捷，并且在静态文件中，修改不需要重新编译，替换即可；</p>
<ul>
<li><p>注册Servlet三大组件（Servlet，Filter，Listener）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册三大组件; 在@Configuration注解的Spring配置类下</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">myServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ServletRegistrationBean registrationBean =</span><br><span class="line">            <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> MyServlet(),<span class="string">&quot;/myServlet&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> registrationBean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">myFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FilterRegistrationBean filterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean();</span><br><span class="line">    filterRegistrationBean.setFilter(<span class="keyword">new</span> MyFilter());</span><br><span class="line">    filterRegistrationBean.setUrlPatterns(Arrays.asList(<span class="string">&quot;/myServlet&quot;</span>));</span><br><span class="line">    <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ServletListenerRegistrationBean <span class="title">myListener</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ServletListenerRegistrationBean servletListenerRegistrationBean</span><br><span class="line">            = <span class="keyword">new</span> ServletListenerRegistrationBean(<span class="keyword">new</span> MyListener());</span><br><span class="line">    <span class="keyword">return</span> servletListenerRegistrationBean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>当然，这三大组件要重新定义一下才能实现定制</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;hello MyServlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;My Filter Process!!!&quot;</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springwebrestfulcrud.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyListener</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextInitialized...web应用启动&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextDestroyed...web应用销毁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="2-SpringBoot配置使用其它的Servlet容器"><a href="#2-SpringBoot配置使用其它的Servlet容器" class="headerlink" title="2. SpringBoot配置使用其它的Servlet容器"></a>2. SpringBoot配置使用其它的Servlet容器</h4><ul>
<li><p>首先排除tomcat的依赖（SpringBoot默认的Servlet容器就是Tomcat）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span> <span class="comment">&lt;!--    排除tomcat ，为了使用其它servlet容器  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加其它Servlet容器的依赖（如：jetty，undertow）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加jetty的依赖 ，jetty是一种servlet容器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加undertow的依赖 ，undertow是一种servlet容器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line">【注】：上面两个servlet容器选择一个即可</span><br><span class="line"></span><br><span class="line">## 9. 使用外置的Servlet容器</span><br><span class="line"></span><br><span class="line">- 嵌入式Servlet容器：jar；</span><br><span class="line"></span><br><span class="line">  - 优点：简单、便携；</span><br><span class="line">  - 默认不支持JSP，优化定制比较复杂；</span><br><span class="line"></span><br><span class="line">- 外置的Servlet容器：war；</span><br><span class="line"></span><br><span class="line">  - 使用外部Servlet容器时，首先要创建一个war包的web项目，然后将tomcat设置为provided，即外部提供;然后将tomcat部署好，即传统做法--&gt;Edit Configuration；</span><br><span class="line"></span><br><span class="line">    ```xml</span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>运行时，要运行war项目自带的ServletInitializer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletInitializer</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder application)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> application.sources(SpringBoot04WebJspApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h1 id="五、Docker"><a href="#五、Docker" class="headerlink" title="五、Docker"></a>五、Docker</h1><h2 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h2><p>Docker是一个<strong>开源的应用容器引擎</strong>（类似于虚拟机，或者说镜像），有了Docker，进入一个新系统后就不用一个一个地下载安装软件了，而是有一个镜像，这个镜像可以直接移植配置好了的各种软件；</p>
<h2 id="2、核心概念"><a href="#2、核心概念" class="headerlink" title="2、核心概念"></a>2、核心概念</h2><ul>
<li>docker主机（Host）：安装了Docker程序的机器（Docker直接安装在操作系统之上）；</li>
<li>docker客户端（Client）：连接docker主机进行操作，通过命令行或其它工具使用Docker；</li>
<li>docker仓库（Repository）：用来保存各种打包好的软件镜像</li>
<li>docker镜像（Images）：软件打包好的镜像；放在docker仓库中；</li>
</ul>
<h3 id="使用Docker的步骤"><a href="#使用Docker的步骤" class="headerlink" title="使用Docker的步骤"></a>使用Docker的步骤</h3><ol>
<li>安装Docker</li>
<li>去Docker仓库找到这个软件对应的镜像；</li>
<li>使用Docker运行这个镜像，这个镜像就会生成一个Docker容器；</li>
<li>对容器的启动停止即对软件的启动停止</li>
</ol>
<h2 id="3、安装Docker（for-Mac）"><a href="#3、安装Docker（for-Mac）" class="headerlink" title="3、安装Docker（for Mac）"></a>3、安装Docker（for Mac）</h2><ol>
<li>Docker下载dmg文件；</li>
<li>拖入Applications安装；</li>
<li>测试是否安装成功(docker -v)；</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~ wjtang$ docker -v</span><br><span class="line">Docker version 19.03.13, build 4484c46d9d</span><br></pre></td></tr></table></figure>

<h2 id="4、Docker常用命令"><a href="#4、Docker常用命令" class="headerlink" title="4、Docker常用命令"></a>4、Docker常用命令</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用Docker查找mysql镜像</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker search mysql</span></span><br><span class="line"><span class="attr">NAME</span>                              <span class="string">DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span></span><br><span class="line"><span class="attr">mysql</span>                             <span class="string">MySQL is a widely used, open-source relation…   10159               [OK]                </span></span><br><span class="line"><span class="attr">mariadb</span>                           <span class="string">MariaDB is a community-developed fork of MyS…   3740                [OK]                </span></span><br><span class="line"><span class="meta">mysql/mysql-server</span>                <span class="string">Optimized MySQL Server Docker images. Create…   742                                     [OK]</span></span><br><span class="line"><span class="attr">...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#利用Docker下载mysql</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker pull mysql</span></span><br><span class="line"><span class="attr">Using</span> <span class="string">default tag: latest</span></span><br><span class="line"><span class="attr">latest</span>: <span class="string">Pulling from library/mysql</span></span><br><span class="line"><span class="attr">bb79b6b2107f</span>: <span class="string">Downloading [===============================&gt;                   ]  16.98MB/27.09MB</span></span><br><span class="line"><span class="attr">49e22f6fb9f7</span>: <span class="string">Download complete </span></span><br><span class="line"><span class="attr">842b1255668c</span>: <span class="string">Download complete </span></span><br><span class="line"><span class="attr">9f48d1f43000</span>: <span class="string">Download complete </span></span><br><span class="line"><span class="attr">...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#下载带版本号的mysql</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker pull mysql:5.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看当前系统中的镜像</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker images</span></span><br><span class="line"><span class="attr">REPOSITORY</span>               <span class="string">TAG                 IMAGE ID            CREATED             SIZE</span></span><br><span class="line"><span class="meta">docker/getting-started</span>   <span class="string">latest              67a3629d4d71        10 days ago         27.2MB</span></span><br><span class="line"><span class="attr">mysql</span>                    <span class="string">latest              db2b37ec6181        3 weeks ago         545MB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除镜像  ~ wjtang$ docker rmi image_id</span></span><br><span class="line"><span class="comment">#这里的 image_id 可以通过 “查看当前系统中的镜像”即docker images命令 查出来,例如要删除查出来的mysql</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker rmi db2b37ec6181</span></span><br><span class="line"><span class="attr">Untagged</span>: <span class="string">mysql:latest</span></span><br><span class="line"><span class="attr">Untagged</span>: <span class="string">mysql@sha256:8c17271df53ee3b843d6e16d46cff13f22c9c04d6982eb15a9a47bd5c9ac7e2d</span></span><br><span class="line"><span class="attr">Deleted</span>: <span class="string">sha256:db2b37ec6181ee1f367363432f841bf3819d4a9f61d26e42ac16e5bd7ff2ec18</span></span><br><span class="line"><span class="attr">...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#运行镜像，运行后产生容器</span></span><br><span class="line"><span class="comment">#-d 代表daemon，即后台运行；mysql:latest中的latest指的是上一步查出来的TAG</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker run --name mysql_personal_name -d mysql:latest</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看当前运行的docker容器</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker ps</span></span><br><span class="line"><span class="attr">CONTAINER</span> <span class="string">ID        IMAGE                    COMMAND                  CREATED             STATUS              PORTS                NAMES</span></span><br><span class="line"><span class="attr">4cefb266d041</span>        <span class="string">docker/getting-started   &quot;/docker-entrypoint.…&quot;   8 minutes ago       Up 8 minutes        0.0.0.0:80-&gt;80/tcp   hungry_haibt</span></span><br><span class="line"><span class="comment">#查看所有容器</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker ps -a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#启动容器,通过容器id</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">start 4cefb266d041</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#停止运行中的容器</span></span><br><span class="line"><span class="comment">#通过上一步查出来的id来停止</span></span><br><span class="line"><span class="meta">~</span> <span class="string">wjtang$ docker stop 4cefb266d041</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#端口映射</span></span><br><span class="line"><span class="comment">#主机端口:容器端口</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run -d -p 8888:8080 tomcat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#更多命令参考</span></span><br><span class="line"><span class="attr">https</span>:<span class="string">//docs.docker.com/engine/reference/commandline/docker</span></span><br></pre></td></tr></table></figure>

<h2 id="5、Docker的容器操作"><a href="#5、Docker的容器操作" class="headerlink" title="5、Docker的容器操作"></a>5、Docker的容器操作</h2><ul>
<li>软件镜像–&gt;运行镜像–&gt;产生容器（正在运行的软件）</li>
</ul>
<p>【注】：这些步骤可参考 “4、Docker常用命令” 所演示的步骤</p>
<h1 id="六、SpringBoot与数据访问"><a href="#六、SpringBoot与数据访问" class="headerlink" title="六、SpringBoot与数据访问"></a>六、SpringBoot与数据访问</h1><h2 id="1-JDBC"><a href="#1-JDBC" class="headerlink" title="1. JDBC"></a>1. JDBC</h2><h3 id="1-使用mysql"><a href="#1-使用mysql" class="headerlink" title="1. 使用mysql"></a>1. 使用mysql</h3><ul>
<li>配置好jdbc的参数</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">15152697858.*twj</span></span><br><span class="line"><span class="comment">#localhost:3306/mysql 其中的mysql是数据库名</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mysql</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springboot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringBoot06DataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        Connection connection = dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>DataSourceConfiguration.class配置了与JDBC相关的配置</li>
</ul>
<h3 id="2-项目运行时，运行sql脚本"><a href="#2-项目运行时，运行sql脚本" class="headerlink" title="2. 项目运行时，运行sql脚本"></a>2. 项目运行时，运行sql脚本</h3><ul>
<li><p>新建一个sql脚本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="keyword">test</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">test</span>(<span class="keyword">id</span> <span class="built_in">varchar</span>(<span class="number">10</span>) , <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">10</span>));</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置sql脚本</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#配置sqlscript.sql所在的路径</span></span><br><span class="line"><span class="meta">spring.datasource.schema</span>=<span class="string">classpath:sqlscript.sql</span></span><br><span class="line"><span class="meta">spring.datasource.initialization-mode</span>=<span class="string">always</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行测试</p>
</li>
</ul>
<p>【注】：mysql的驱动版本要正确，否则项目运行不了</p>
<h3 id="3-SpringBoot操纵数据库"><a href="#3-SpringBoot操纵数据库" class="headerlink" title="3. SpringBoot操纵数据库"></a>3. SpringBoot操纵数据库</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.springboot.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate; <span class="comment">//SpringBoot内置JdbcTemplate用来查询数据库</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/queryUsers&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">map</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; list = jdbcTemplate.queryForList(<span class="string">&quot;select * from Users&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【注】：SpringBoot内置JdbcTemplate用来查询数据库；具体的数据库配置在配置文件中（application.properties等）</p>
<h3 id="4-Druid作为数据源"><a href="#4-Druid作为数据源" class="headerlink" title="4.  Druid作为数据源"></a>4.  Druid作为数据源</h3><ul>
<li>导入druid的依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>配置文件</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#spring.datasource.schema=classpath:sqlscript.sql #先注释掉原本的数据源</span></span><br><span class="line"><span class="meta">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>【注】：druid这一章节没有写全，以后用到的话再补充；</p>
<h2 id="2-MyBatis"><a href="#2-MyBatis" class="headerlink" title="2. MyBatis"></a>2. MyBatis</h2><h3 id="1-Spring-Boot整合MyBatis"><a href="#1-Spring-Boot整合MyBatis" class="headerlink" title="1. Spring Boot整合MyBatis"></a>1. Spring Boot整合MyBatis</h3><ul>
<li><p>首先要导入mybatis-spring-boot的整合jar包依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.spring.boot/mybatis-spring-boot-starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>建表，并写好javaBean</p>
</li>
</ul>
<h4 id="1）-使用MyBatis注解"><a href="#1）-使用MyBatis注解" class="headerlink" title="1） 使用MyBatis注解"></a>1） 使用MyBatis注解</h4><ul>
<li><p>写好Mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from Users where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">getUsersById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from Users where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteUsersById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into Users(id,name,password,money) values(#&#123;id&#125;,#&#123;name&#125;,#&#123;password&#125;,#&#123;money&#125;)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">insertUsers</span><span class="params">(Users users)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update Users set name=#&#123;name&#125; where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateUsers</span><span class="params">(Users users)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>写好Controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UsersMapper usersMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/Users/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">getUsers</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span><span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        Users users = usersMapper.getUsersById(id);</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">  	<span class="comment">//@Options(useGeneratedKeys = true,keyProperty = &quot;id&quot;) //使用自增主键</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/insertUsers&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">insertUsers</span><span class="params">(Users users)</span></span>&#123;</span><br><span class="line">        usersMapper.insertUsers(users);</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/deleteUsers/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteUsers</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span><span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = usersMapper.deleteUsersById(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;删除了&quot;</span>+count+<span class="string">&quot;行的用户&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-使用MyBatis非注解"><a href="#2-使用MyBatis非注解" class="headerlink" title="2) 使用MyBatis非注解"></a>2) 使用MyBatis非注解</h4><ul>
<li><p>写好MyBatis配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;environments default=&quot;development&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;environment id=&quot;development&quot;&gt;</span></span><br><span class="line"><span class="comment">            &lt;transactionManager type=&quot;JDBC&quot;/&gt;</span></span><br><span class="line"><span class="comment">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span></span><br><span class="line"><span class="comment">                &lt;property name=&quot;driver&quot; value=&quot;$&#123;driver&#125;&quot;/&gt;</span></span><br><span class="line"><span class="comment">                &lt;property name=&quot;url&quot; value=&quot;$&#123;url&#125;&quot;/&gt;</span></span><br><span class="line"><span class="comment">                &lt;property name=&quot;username&quot; value=&quot;$&#123;username&#125;&quot;/&gt;</span></span><br><span class="line"><span class="comment">                &lt;property name=&quot;password&quot; value=&quot;$&#123;password&#125;&quot;/&gt;</span></span><br><span class="line"><span class="comment">            &lt;/dataSource&gt;</span></span><br><span class="line"><span class="comment">        &lt;/environment&gt;</span></span><br><span class="line"><span class="comment">    &lt;/environments&gt;</span></span><br><span class="line"><span class="comment">    &lt;mappers&gt;</span></span><br><span class="line"><span class="comment">        &lt;mapper resource=&quot;org/mybatis/example/BlogMapper.xml&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;/mappers&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--注：environments 以及 mappers 都在全局配置文件（如application.properties）中进行配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>写好Mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.atguigu.springboot.mapper.UsersMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUsersById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.springboot.bean.Users&quot;</span>&gt;</span></span><br><span class="line">    select * from Users where id = #&#123;id&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUsers&quot;</span> &gt;</span></span><br><span class="line">    insert into Users(id,name,password,money) values(#&#123;id&#125;,#&#123;name&#125;,#&#123;password&#125;,#&#123;money&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在全局配置文件（此处为application.properties）进行相关配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mybatis.config-location</span>=<span class="string">classpath:mybatis/mybatis-config.xml</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mybatis/mapper/*.xml</span></span><br><span class="line"><span class="comment">#注：数据库相关配置在前面已经配置过了</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>写好Mapper.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//非注解</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">getUsersById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">insertUsers</span><span class="params">(Users users)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>写Controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UsersMapper usersMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/Users/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">getUsers</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span><span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        Users users = usersMapper.getUsersById(id);</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@Options(useGeneratedKeys = true,keyProperty = &quot;id&quot;) //使用自增主键</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/insertUsers&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">insertUsers</span><span class="params">(Users users)</span></span>&#123;</span><br><span class="line">        usersMapper.insertUsers(users);</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//注：非注解的Controller与注解的Controller没区别</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-SpringBoot整合JPA"><a href="#2-SpringBoot整合JPA" class="headerlink" title="2.SpringBoot整合JPA"></a>2.SpringBoot整合JPA</h3><ul>
<li><p>编写bean与数据库表映射（使用JPA相关注解）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span> <span class="comment">//告诉JPA这是一个实体类</span></span><br><span class="line"><span class="meta">@Table(name=&quot;Users&quot;)</span> <span class="comment">//映射表名，省略则表名默认为类名</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Id</span>  <span class="comment">//标志主键</span></span><br><span class="line">  <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span> <span class="comment">//自增主键</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column(name = &quot;name&quot;)</span> <span class="comment">//标志表中的某列，这个注解默认省略</span></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String password;</span><br><span class="line">  <span class="keyword">private</span> String money;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.password = password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> money;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(String money)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.money = money;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Dao接口进行增删改查（这里的dao称为Repository）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Users</span>,<span class="title">Integer</span>&gt; </span>&#123; <span class="comment">//Users为实体类，String为@Id（主键）的类型</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注： JpaRepository中内置了crud（增删改查），继承之后我们就不用写crud对应的sql语句了</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>基本的配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mysql</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">15152697858</span><span class="string">.*twj</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="comment">#ddl-auto 定义数据表的生成策略，update 没有则建表，有则更新</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Controller进行测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UsersRepository usersRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/Users/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">getUsers</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id)</span></span>&#123;</span><br><span class="line">        Users users = usersRepository.findById(id).get();</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/insertUsers&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Users <span class="title">insertUsers</span><span class="params">(Users users)</span></span>&#123;</span><br><span class="line">        Users newUsers = usersRepository.save(users);</span><br><span class="line">        <span class="keyword">return</span> newUsers;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/15/SpringBootLerningNotes/" data-id="ckji59yy50005hpxgf0t9c5gz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/10/20/%E5%85%B3%E4%BA%8E%E6%9C%9F%E5%88%8A%E7%9A%84%E7%9F%A5%E8%AF%86/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          关于期刊的知识
        
      </div>
    </a>
  
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/04/Postman%E8%AE%BE%E7%BD%AEcookie/">Postman设置cookie</a>
          </li>
        
          <li>
            <a href="/2020/10/20/Mac%E8%A7%A3%E5%86%B3Tomcat%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98/">Mac解决Tomcat端口被占用问题</a>
          </li>
        
          <li>
            <a href="/2020/10/20/Mac%E5%AE%89%E8%A3%85%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%88%E9%97%AE%E9%A2%98&%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%89/">Mac安装开发环境（问题&amp;解决方案）</a>
          </li>
        
          <li>
            <a href="/2020/10/20/%E6%84%9F%E7%9F%A5%E6%9C%BA%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/">感知机模型的代码实现</a>
          </li>
        
          <li>
            <a href="/2020/10/20/%E5%85%B3%E4%BA%8E%E6%9C%9F%E5%88%8A%E7%9A%84%E7%9F%A5%E8%AF%86/">关于期刊的知识</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>